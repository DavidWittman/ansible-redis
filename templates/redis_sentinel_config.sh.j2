#!/bin/sh
# This script is generated by Ansible to reconfigure Sentinel while running.
{% set cli = "/usr/bin/redis-cli -p " + (redis_sentinel_port|string) %}

{% for master in redis_sentinel_monitors -%}
{{ cli }} sentinel monitor {{ master.name }} `dig +short {{ master.host }}` {{ master.port }} {{ master.quorum|d('2') }}
{% for option in ('auth_pass', 'down_after_milliseconds', 'parallel_syncs', 'failover_timeout', 'notification_script', 'client_reconfig_script') -%}
{% if master[option] is defined and master[option] -%}
{{ cli }} sentinel set {{ master.name }} {{ option|replace('_', '-') }} {{ master[option] }}
{% endif %}
{% endfor -%}
{% endfor -%}
